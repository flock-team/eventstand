<div class="chat">
  <ng-container *ngIf="chats$ | async as chats">
    <div
      class="chat__content"
      *ngFor="let chat of chats | slice: 0:[last] - 1; last as last"
    >
      <div class="chat__item">
        <figure
          class="chat__avatar"
          [style.background-image]="'url(' + chat.user?.avatarURL + ')'"
        ></figure>
        <div class="chat__body">
          <p class="chat__body">
            <span class="chat__name">
              {{ chat.user?.name }}
            </span>
            <quill-view-html [content]="chat.chatBody" theme="snow">
            </quill-view-html>
          </p>
          <p class="chat__date">
            {{ chat.createdAt.toDate() | date: 'M/d HH:mm' }}
          </p>
        </div>
        <div>
          <button
            mat-icon-button
            [mat-menu-trigger-for]="chatEditor"
            type="button"
          >
            <mat-icon>more_vert</mat-icon>
          </button>
          <mat-menu #chatEditor="matMenu">
            <button
              mat-menu-item
              type="button"
              (click)="deleteChat(chat.chatId)"
            >
              <mat-icon>delete</mat-icon>
              削除
            </button>
          </mat-menu>
        </div>
      </div>
    </div>

    <div class="chat__item" *ngFor="let chat of chats | slice: -1" #target>
      <figure
        class="chat__avatar"
        [style.background-image]="'url(' + chat.user?.avatarURL + ')'"
      ></figure>
      <div class="chat__body">
        <p class="chat__body">
          <span class="chat__name">
            {{ chat.user?.name }}
          </span>
          <quill-view-html [content]="chat.chatBody" theme="snow">
          </quill-view-html>
        </p>
        <p class="chat__date">
          {{ chat.createdAt.toDate() | date: 'M/d HH:mm' }}
        </p>
      </div>
      <div>
        <button
          mat-icon-button
          [mat-menu-trigger-for]="chatEditor"
          type="button"
        >
          <mat-icon>more_vert</mat-icon>
        </button>
        <mat-menu #chatEditor="matMenu">
          <button mat-menu-item type="button" (click)="deleteChat(chat.chatId)">
            <mat-icon>delete</mat-icon>
            削除
          </button>
        </mat-menu>
      </div>
    </div>
  </ng-container>
</div>

<div class="chat-form chat-form--sp">
  <quill-editor
    [formControl]="form"
    [styles]="{ height: '40px', width: '80%' }"
    [placeholder]="'コメントを入力'"
  >
    <div quill-editor-toolbar>
      <span class="ql-formats">
        <button class="ql-emoji" [title]="'絵文字'"></button>
      </span>
      <span class="ql-formats">
        <button class="ql-link" [title]="'リンク'"></button>
      </span>
    </div>
  </quill-editor>
  <button class="chat-form__submit chat-form__submit--sp">
    <mat-icon (click)="createChat()">send</mat-icon>
  </button>
</div>

<div class="chat-form">
  <quill-editor
    [formControl]="form"
    [styles]="{ height: '40px' }"
    [placeholder]="'コメントを入力'"
    customToolbarPosition="bottom"
  >
    <div quill-editor-toolbar>
      <span class="ql-formats">
        <button class="ql-emoji" [title]="'絵文字'"></button>
      </span>
      <span class="ql-formats">
        <button class="ql-link" [title]="'リンク'"></button>
      </span>
      <span class="ql-formats">
        <button class="ql-image" [title]="'画像'"></button>
      </span>
      <span class="ql-formats">
        <button class="ql-video" [title]="'YouTube'"></button>
      </span>
    </div>
    <button></button>
  </quill-editor>
</div>
<button class="chat-form__submit">
  <mat-icon (click)="createChat()">send</mat-icon>
</button>
